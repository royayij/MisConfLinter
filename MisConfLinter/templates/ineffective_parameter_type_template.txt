from typing import TYPE_CHECKING, Any, Dict, Union
# Auto Generated Rules. Do not change manually
from ansiblelint.rules import AnsibleLintRule
import re

if TYPE_CHECKING:
    from typing import Optional

    from ansiblelint.file_utils import Lintable

class {{rule_name}}(AnsibleLintRule):
    id = '{{rule_id}}'
    shortdesc = '{{rule_desc_short}}'
    description = '{{rule_desc}}'
    tags = ['{{misconfiguration_type}}']

    _modules = ['{{modules_sel}}']

    ign_params = {{ign_val}}

    def matchtask(
        self, task: Dict[str, Any], file: 'Optional[Lintable]' = None) -> Union[bool, str]:

        if task["action"]["__ansible_module__"].split('.')[-1] in self._modules:
            for item in self.ign_params['choices'].keys():
                if len(self.ign_params['choices'][item]) != 0:
                    if 'not' in self.ign_params['choices'][item]:
                        if (task['action'].get(item, None) is not None) and (task['action'].get(self.ign_params['param_name'], None) is not None):
                            print('ignored')
                            return True
                    elif task['action'].get(item, None) in self.ign_params['choices'][item]:
                        if task['action'].get(self.ign_params['param_name'], None) is not None:
                            print('ignored')
                            return True
                else:
                    if task['action'].get(item, None) is not None:
                        if task['action'].get(self.ign_params['param_name'], None) is not None:
                            print('ignored')
                            return True

        return False